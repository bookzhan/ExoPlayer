// Copyright (C) 2016 The Android Open Source Project
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//      http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
apply from: "$gradle.ext.exoplayerSettingsDir/common_library_config.gradle"
apply plugin:"com.kezong.fat-aar"

dependencies {
    embed ('com.google.guava:guava:' + guavaVersion) {
        // Exclude dependencies that are only used by Guava at compile time
        // (but declared as runtime deps) [internal b/168188131].
        exclude group: 'com.google.code.findbugs', module: 'jsr305'
        exclude group: 'org.checkerframework', module: 'checker-compat-qual'
        exclude group: 'com.google.errorprone', module: 'error_prone_annotations'
        exclude group: 'com.google.j2objc', module: 'j2objc-annotations'
        exclude group: 'org.codehaus.mojo', module: 'animal-sniffer-annotations'
    }
    embed project(modulePrefix + 'library-common')
    embed project(modulePrefix + 'library-extractor')
    embed project(modulePrefix + 'library-core')
    embed project(modulePrefix + 'library-dash')
    embed project(modulePrefix + 'library-hls')
    embed project(modulePrefix + 'library-rtsp')
    embed project(modulePrefix + 'library-smoothstreaming')
    embed project(modulePrefix + 'library-transformer')
    embed project(modulePrefix + 'library-ui')
}

ext {
    publish_group_id = 'io.github.bookzhan'
    publish_artifact_id = "exoplayer"
    publish_version = '2.14.1'
    publish_description = 'exoplayer'

    developer_id = 'guaishou'
    developer_name = 'bookzhan'
    developer_email = 'bookzhan@qq.com'

    github_name = 'bookzhan'
    github_project_name = 'ExoPlayer'
    github_project_url = 'https://github.com/bookzhan/ExoPlayer'
}
File secretPropsFile = project.rootProject.file('local.properties')
if (secretPropsFile.exists()) {
    Properties p = new Properties()
    p.load(new FileInputStream(secretPropsFile))
    if(p.containsKey("signing.keyId")&&p.containsKey("signing.password")&&p.containsKey("signing.secretKeyRingFile")
            &&p.containsKey("ossrhUsername")&&p.containsKey("ossrhPassword")){
        apply from: 'https://raw.githubusercontent.com/bookzhan/maven-publish-gradle/master/publish.gradle'
        println("Configuration information detected")
        task uploadToMavenCentral(group: 'publishing') {
            dependsOn(assemble)
            dependsOn(publishReleasePublicationToMavencentralRepository)
        }
    }else {
        println("Please configure the signature and account information in the local.properties file")
    }
}


//apply from: '../../publish.gradle'
